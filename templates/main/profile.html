{% extends "base.html" %}

{% block title %}Meu Perfil — InStruct{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="profile-edit-container">
            <h1 class="profile-edit-title">Editar Perfil</h1>
            
            <form class="profile-edit-form" method="POST" enctype="multipart/form-data">
                <!-- Avatar -->
                <div class="profile-edit-avatar-section">
                    <img class="profile-edit-avatar" 
                         src="https://api.dicebear.com/9.x/lorelei/svg?seed=user&backgroundColor=b6e3f4,c0aede,d1d4f9,ffd5dc" 
                         alt="Avatar do usuário"
                         id="avatarPreview">
                    <label for="avatarInput" class="profile-edit-avatar-button">
                        <i class="bi bi-camera"></i>
                    </label>
                    <input type="file" id="avatarInput" name="avatar" accept="image/*" hidden>
                </div>

                <!-- Campos -->
                <div class="mb-3">
                    <label for="fullName" class="form-label">Nome Completo</label>
                    <input type="text" class="form-control" id="fullName" name="full_name" placeholder="Digite seu nome completo" required>
                </div>

                <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" class="form-control" id="email" name="email" placeholder="seu.email@gmail.com" required>
                </div>

                <div class="mb-3">
                    <label for="username" class="form-label">Nome de Usuário</label>
                    <input type="text" class="form-control" id="username" name="username" placeholder="seu_nome_usuario" required>
                </div>

                <div class="mb-3">
                    <label for="bio" class="form-label">Bio</label>
                    <textarea class="form-control" id="bio" name="bio" rows="3" placeholder="Conte um pouco sobre você..."></textarea>
                </div>

                <div class="mb-3">
                    <label for="location" class="form-label">Localização</label>
                    <input type="text" class="form-control" id="location" name="location" placeholder="Sua localização">
                </div>

                <div class="mb-3">
                    <label for="github" class="form-label">Github</label>
                    <input type="url" class="form-control" id="github" name="github" placeholder="https://github.com/seu-usuario">
                </div>

                <!-- Salvar ou Cancelar -->
                <div class="profile-edit-actions">
                    <button type="submit" class="btn btn-primary profile-edit-save">
                        <i class="bi bi-check"></i>
                        <span>Salvar Alterações</span>
                    </button>
                    <a href="{{ url_for('main.home') }}" class="btn btn-outline-secondary profile-edit-cancel">
                        <i class="bi bi-x"></i>
                        <span>Cancelar</span>
                    </a>
                </div>
            </form>

            <!-- Deletar conta -->
            <div class="profile-edit-danger-zone">
                <h3>Zona de Perigo</h3>
                <p>Estas ações não podem ser desfeitas. Por favor, seja cuidadoso.</p>
                <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteAccountModal">
                    <i class="bi bi-trash"></i>
                    <span>Deletar Conta</span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal qie confirma a exclusão -->
<div class="modal fade" id="deleteAccountModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-danger">
                <h5 class="modal-title text-danger">
                    <i class="bi bi-exclamation-triangle"></i>
                    Deletar Conta
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p><strong>Tem certeza que deseja deletar sua conta?</strong></p>
                <p>Esta ação é irreversível. Todos os seus dados, publicações e informações serão permanentemente removidos.</p>
                <p class="text-muted">Digite sua senha para confirmar:</p>
                <input type="password" class="form-control" id="passwordConfirm" placeholder="Sua senha">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-danger">Deletar Permanentemente</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Previa da imagem do avatar antes do upload de fato 
    const avatarInput = document.getElementById('avatarInput');
    const avatarPreview = document.getElementById('avatarPreview');

    if (avatarInput) {
        avatarInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {avatarPreview.src = event.target.result;};
                reader.readAsDataURL(file);
            }
        });
    }
</script>
{% endblock %}
